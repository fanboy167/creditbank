{% extends "instructor/instructor_layout.html" %}
{% block title %}เพิ่มวิดีโอใหม่{% endblock %}

{% block content %}
<div class="container mt-4">
    <h2 class="mb-4">เพิ่มวิดีโอสำหรับบทเรียน: {{ lesson.lesson_name }}</h2>
    <div class="card shadow-sm">
        <div class="card-body">
            <form method="POST" enctype="multipart/form-data">
                
                <div class="mb-3">
                    <label for="title" class="form-label">ชื่อวิดีโอ</label>
                    <input type="text" class="form-control" id="title" name="title" required>
                </div>

                <!-- VVVVVV ส่วนที่แก้ไข VVVVVV -->
                <div class="mb-3">
                    <label class="form-label">แหล่งที่มาของวิดีโอ</label>
                    <div class="form-check">
                        <input class="form-check-input" type="radio" name="video_source" id="source_youtube" value="youtube" checked>
                        <label class="form-check-label" for="source_youtube">
                            ลิงก์ YouTube
                        </label>
                    </div>
                    <div class="form-check">
                        <input class="form-check-input" type="radio" name="video_source" id="source_upload" value="upload">
                        <label class="form-check-label" for="source_upload">
                            อัปโหลดไฟล์โดยตรง (mp4, mov, etc.)
                        </label>
                    </div>
                </div>

                <!-- ช่องสำหรับ YouTube -->
                <div id="youtube_field" class="mb-3">
                    <label for="youtube_link" class="form-label">ลิงก์ YouTube</label>
                    <input type="url" class="form-control" id="youtube_link" name="youtube_link" placeholder="https://youtube.com/watch?v=xxxx">
                </div>

                <!-- ช่องสำหรับอัปโหลด -->
                <div id="upload_field" class="mb-3" style="display: none;">
                    <label for="video_file" class="form-label">เลือกไฟล์วิดีโอ</label>
                    <input class="form-control" type="file" id="video_file" name="video_file" accept="video/*">
                </div>
                <!-- ^^^^^^ สิ้นสุดการแก้ไข ^^^^^^ -->

                <div class="mb-3">
                    <label for="description" class="form-label">คำอธิบาย</label>
                    <textarea class="form-control" id="description" name="description" rows="3"></textarea>
                </div>

                <div class="row">
                    <div class="col-md-6 mb-3">
                        <label for="time_duration" class="form-label">ระยะเวลา (เช่น 12:34)</label>
                        <input type="text" class="form-control" id="time_duration" name="time_duration" placeholder="00:00">
                    </div>
                    <div class="col-md-6 mb-3">
                        <label for="video_image" class="form-label">เลือกรูปภาพตัวอย่าง</label>
                        <input class="form-control" type="file" id="video_image" name="video_image" accept="image/*">
                    </div>
                </div>

                <button type="submit" class="btn btn-primary">บันทึก</button>
                <a href="{{ url_for('instructor_dashboard') }}" class="btn btn-secondary">ยกเลิก</a>
            </form>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
    // Script สำหรับสลับการแสดงผลฟอร์ม
    document.addEventListener('DOMContentLoaded', function() {
        const youtubeRadio = document.getElementById('source_youtube');
        const uploadRadio = document.getElementById('source_upload');
        const youtubeField = document.getElementById('youtube_field');
        const uploadField = document.getElementById('upload_field');
        const youtubeInput = document.getElementById('youtube_link');
        const uploadInput = document.getElementById('video_file');

        function toggleFields() {
            if (youtubeRadio.checked) {
                youtubeField.style.display = 'block';
                uploadField.style.display = 'none';
                youtubeInput.required = true;
                uploadInput.required = false;
            } else {
                youtubeField.style.display = 'none';
                uploadField.style.display = 'block';
                youtubeInput.required = false;
                uploadInput.required = true;
            }
        }

        youtubeRadio.addEventListener('change', toggleFields);
        uploadRadio.addEventListener('change', toggleFields);
        toggleFields();
    });
</script>
{% endblock %}